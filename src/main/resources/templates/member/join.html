<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{common/header::header}"></head>
<style>
    .joinForm{width:400px;margin:100px auto 0;}
    .j_title{font-size: 60px;font-weight: bold;letter-spacing: 20px;color: #000;text-align: center;}
    .join_box{margin: 10px 0 0;border: 1px solid #ddd;border-radius: 3px;background-color: #fff;box-sizing: border-box;}
    .m_form>p{padding:0 19px;font-size: 13px;}
    .input_form{margin: 0;width: 100%;padding: 18px 19px 19px;box-sizing: border-box;}
    .input_form>input{display: block;width: 100%;height: 100%;font-size: 13px;color: #000;border: none;outline: 0;-webkit-appearance: none;background-color: transparent;}
    .password, .name, .email{border-top: 1px solid #ddd;}
    .join_btn{margin: 20px 0 0;width: 100%;height: 48px;border-radius: 3px;font-size: 16px;color: #fff;background-color: #000;border: 0;}
    .join_error{padding-left:20px;color:red;font-size:13px;}
</style>
<script th:inline="javascript">
    function join(){
        $.ajax({
            url: "/member/join",
            data: $("#joinForm").serialize(),
            type: 'POST',
            beforeSend: function(xhr){
                xhr.setRequestHeader(header, token);
            },
            success: function(res){
                if(res.msg=='success'){
                    alert(res.data.uid+'님 환영합니다.')
                    location.href = '/login'
                }else if(res.msg=='dup'){
                    alert('이미 사용중인 아이디입니다.')
                }
            }
        })
    }
    console.log(${saveMember})
    const saveMember = ${saveMember}
    if(saveMember){
        alert(saveMember)
    }
</script>
<body>
    <div th:replace="~{common/bodyUtil::bodyUtil}"></div>
    <div th:replace="~{common/bodyHeader::bodyHeader}"></div>
    <div class="all">
        <form action="/member/join" method="post" th:object="${memberSaveDto}">
            <input type="hidden" th:name="_csrf" th:value="${_csrf.token}"/>
            <div class="joinForm">
                <div class="j_title">BLOG</div>
                <div class="join_box">
                    <div class="m_form">
                        <div class="input_form">
                            <input type="text" th:field="*{uid}" placeholder="ID 4~12글자">
                        </div>
                    </div>
                    <p class="join_error" th:if="${#fields.hasErrors('uid')}" th:errors="*{uid}"></p>
                    <div class="m_form">
                        <div class="input_form password">
                            <input type="password" id="loginPw" name="password" placeholder="Password 8~16글자">
                        </div>
                    </div>
                    <p class="join_error" th:if="${#fields.hasErrors('password')}" th:errors="*{password}"></p>
                    <div class="m_form">
                        <div class="input_form name">
                            <input type="text" id="name" name="name" placeholder="이름">
                        </div>
                    </div>
                    <p class="join_error" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></p>
                    <div class="m_form">
                        <div class="input_form email">
                            <input type="email" id="email" name="email" placeholder="이메일">
                        </div>
                    </div>
                    <p class="join_error" th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></p>
                </div>
                <button type="submit" class="join_btn">회원가입</button>
            </div>
        </form>
    </div>
</body>
</html>